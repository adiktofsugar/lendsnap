#!/bin/bash
project_root=$(cd `dirname ${BASH_SOURCE[0]}`; cd ..; pwd)

read_mode=false
while getopts ":r" opt; do
    case $opt in
        r) read_mode=true;;
        \?) echo "option $OPTARG unsupported"; exit 1;;
    esac
    shift
done

command_name=${1:-}
shift

commands_path=$project_root/ansible/commands
if ! [[ $command_name ]];then
    ls $commands_path
    exit
fi

for file in `ls $commands_path/$command_name`; do
    if [[ $read_mode = true ]];then
        echo "-- $file"
        cat -n $file
        echo ""
    else
        eval $commands_path/$command_name $@
    fi
done

